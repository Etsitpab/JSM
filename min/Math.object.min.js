/**
 * This program is free software: you can redistribute it and/or modify    
 * it under the terms of the GNU General Public License as published by        
 * the Free Software Foundation, either version 3 of the License, or 
 * (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 * 
 * @author Baptiste Mazin     <baptiste.mazin@telecom-paristech.fr> 
 * @author Guillaume Tartavel <guillaume.tartavel@telecom-paristech.fr> 
 */
(function(e){"use strict";var r=.9189385332046728,a=.22579135264472744,t=2.22507e-308,n=2.220446049250313e-16;var i=function(e){return e>0?Math.floor(e):Math.ceil(e)};var f=function(e){var a=171.624;var f=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054];var u=[-30.840230011973897,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.25967555349];var o=[-.001910444077728,.00084171387781295,-.0005952379913043012,.0007936507935003503,-.0027777777777776816,.08333333333333333,.0057083835261];var v,l,s,h,c,M,I,g,N,m,b,p;s=0;h=1;l=0;I=e;if(I<=0){I=-e;N=i(I);m=I-N;if(m!==0){if(N!==i(N*.5)*2){s=1}h=-Math.PI/Math.sin(Math.PI*m);I+=1}else{return Number.POSITIVE_INFINITY}}if(I<n){if(I>=t){m=1/I}else{return Number.POSITIVE_INFINITY}}else if(I<12){N=I;if(I<1){g=I;I+=1}else{l=parseInt(I,10)-1;I-=parseFloat(l);g=I-1}M=0;c=1;for(v=0;v<8;++v){M=(M+f[v])*g;c=c*g+u[v]}m=M/c+1;if(N<I){m/=N}else if(N>I){for(v=0;v<l;++v){m*=I;I+=1}}}else{if(I<=a){p=I*I;b=o[6];for(v=0;v<6;++v){b=b/p+o[v]}b=b/I-I+r;b+=(I-.5)*Math.log(I);m=Math.exp(b)}else{return Number.POSITIVE_INFINITY}}if(s){m=-m}if(h!==1){m=h/m}return m};var u=function(e,r,a){var t,n,i,f,u;if(a<1||a>1e3){return NaN}if(e<-1.1||e>1.1){return NaN}f=e*2;i=n=0;t=0;for(u=1;u<=a;u++){i=n;n=t;t=f*n-i+r[a-u]}return(t-i)*.5};var o=function(e){var r=[+.16663894804518634,-1384948176067564e-20,+9.81082564692473e-9,-1.809129475572494e-11,+6.221098041892606e-14,-3.399615005417722e-16,+2.683181998482699e-18,-2.868042435334643e-20,+3.9628370610464347e-22,-6.831888753985767e-24,+1.4292273559424982e-25,-3.5475981581010704e-27,+1.025680058010471e-28,-3.401102254316749e-30,+1.276642195630063e-31];var a;var t=5;var n=94906265.62425156;var i=3.745194030963158e306;if(e<10){return Number.NaN}if(e>=i){throw"Underflow error in lgammacor"}if(e<n){a=10/e;return u(a*a*2-1,r,t)/e}return 1/(e*12)};var v=function(e,t){var n,u,v;var l=2.5327372760800758e305;var s=1.4901161193847656e-8;if(t!==null){t=1}if(isNaN(e)){return e}if(e<0&&Math.floor(-e)%2===0){if(t!==null){t=-1}}if(e<=0&&e===i(e)){console.warn("Negative integer argument in lgammafn_sign");return Number.POSITIVE_INFINITY}u=Math.abs(e);if(u<=10){return Math.log(Math.abs(f(e)))}if(u>l){console.warn("Illegal arguement passed to lgammafn_sign");return Number.POSITIVE_INFINITY}if(e>0){if(e>1e17){return e*(Math.log(e)-1)}if(e>4934720){return r+(e-.5)*Math.log(e)-e}return r+(e-.5)*Math.log(e)-e+o(e)}v=Math.abs(Math.sin(Math.PI*u));if(v===0){throw"Should never happen!!"}n=a+(e-.5)*Math.log(u)-e-Math.log(v)-o(u);if(Math.abs((e-i(e-.5))*n/e)<s){throw"The answer is less than half the precision argument too close to a negative integer"}return n};var l=function(e){return v(e,null)};var s=function(e,r,a){var t=100;var n=3e-12;var i=1e-30;var f=Math.abs;var u,o,v,l,s,h,c,M,I,g;M=e+r;g=e+1;I=e-1;l=1;s=1-M*a/g;if(f(s)<i){s=i}s=1/s;c=s;for(u=1;u<=t;u++){o=2*u;v=u*(r-u)*a/((I+o)*(e+o));s=1+v*s;if(f(s)<i){s=i}l=1+v/l;if(f(l)<i){l=i}s=1/s;c*=s*l;v=-(e+u)*(M+u)*a/((e+o)*(g+o));s=1+v*s;if(f(s)<i){s=i}l=1+v/l;if(f(l)<i){l=i}s=1/s;h=s*l;c*=h;if(f(h-1)<n){break}}if(u>t){console.warn("a or b too big, or MAXIT too small in betacf: "+e+", "+r+", "+a+", "+c);return c}if(isNaN(c)){console.warn(e+", "+r+", "+a)}return c};var h=function(e,r,a,t){var n;if(e<0||e>1){throw"bad x in routine incompleteBeta"}if(e===0||e===1){n=0}else{n=Math.exp(l(r+a)-l(r)-l(a)+r*Math.log(e)+a*Math.log(1-e))}var i;if(e<(r+1)/(r+a+2)){i=n*s(r,a,e)/r}else{i=1-n*s(a,r,1-e)/a}return t?1-i:i};(function(e){var r=new Float64Array([5.958930743e-11,-1.13739022964e-9,1.466005199839e-8,-1.635035446196e-7,16461004480962e-19,-1492559551950604e-20,.00012055331122299264,-.0008548326981129666,.005223977624823223,-.026866170645077334,.11283791670954882,-.3761263890318375,1.1283791670955126,2.372510631e-11,-4.5493253732e-10,5.90362766598e-9,-6.642090827576e-8,6.7595634268133e-7,-621188515924e-17,510388300970969e-19,-.00037015410692956176,.00233307631218881,-.012549884771821921,.05657061146827042,-.21379664776456006,.8427007929497149,9.49905026e-12,-1.8310229805e-10,2.39463074e-9,-2.721444369609e-8,2.8045522331686e-7,-261830022482897e-20,2195455056768781e-20,-.00016358986921372656,.0010705215356411031,-.006082847181135901,.029869784652462584,-.13055593046562267,.674933236039655,3.82722073e-12,-7.421598602e-11,9.793057408e-10,-1.126008898854e-8,1.1775134830784e-7,-11199275838265e-19,962023443095201e-20,-7404402135070773e-20,.0005068999365414488,-.003075530514392729,.016689778925531657,-.08548534594781312,.5690907664239364,1.55296588e-12,-3.032205868e-11,4.0424830707e-10,-4.71135111493e-9,5.011915876293e-8,-4.8722516178974e-7,430683284629395e-20,-3445026145385764e-20,.00024879276133931664,-.0016294094174807928,.009887863739323505,-.05962426839442304,.49766113250947636]);var a=new Float64Array([-2.9734388465e-10,2.69776334046e-9,-6.40788827665e-9,-1.6678201321e-8,-2.1854388148686e-7,266246030457984e-20,1612722157047886e-20,-.00025616361025506627,.00015380842432375364,.00815533022524928,-.014022836638963193,-.19746892495383023,.7151172032884284,-1.951073787e-11,-3.2302692214e-10,5.22461866919e-9,3.42940918551e-9,-3.5772874310272e-7,1.9999935792654e-7,2687044575042908e-20,-.00011843240273775776,-.0008099172895603227,.006610629705022412,.009095309223548273,-.20160072778491014,.5116969671872764,3.147682272e-11,-4.8465972408e-10,6.3675740242e-10,3.377623323271e-8,-1.5451139637086e-7,-203340624738438e-20,1947204525295057e-20,2854147231653228e-20,-.0010156506315220028,.0027118700352009566,.023280950354228107,-.16725021123116876,.32490054966649434,2.31936337e-11,-6.303206648e-11,-2.64888267434e-9,2.050708040581e-8,1.1371857327578e-7,-211211337219663e-20,368797328322935e-20,9823686253424796e-20,-.0006586024399045536,-.0007528581489523087,.025854344242029606,-.11637092784486193,.1826733677529661,-3.67789363e-12,2.0876046746e-10,-1.93319027226e-9,-4.35953392472e-9,1.8006992266137e-7,-7.8441223763969e-7,-675407647949153e-20,8428418334440096e-20,-.00017604388937031816,-.002397296114350716,.02064129023876023,-.06905562880005864,.09084526782065479]);var t=function(e,t){var n=3.97886080735226;var i=.2753747415973768;var f=.49016508058531844;var u=.7743681991195386;var o=1.0792551515585667;var v=1.313146538310231;var l=1.3704021768233816;var s=1.1890298290927332;var h=.8052764087529106;var c=.35752427444953105;var M=.016620792496936737;var I=-.11946395996432542;var g=-.0838864557023002;var N=.002493672000535033;var m=.039097684558848406;var b=.016131532973325226;var p=-.013382364453346007;var w=-.012722381378212275;var T=.003833351262648873;var P=.007736725283135267;var F=-.0008707796353172959;var q=-.003963850973605135;var _=.00011931402283834095;var d=.0012710976495261409;var x,S,E,O,V;if(t===0){x=Math.abs(e);if(x<2.2){S=x*x;E=Math.floor(S);S=S-E;E=E*13;O=((((((((((((r[E]*S+r[E+1])*S+r[E+2])*S+r[E+3])*S+r[E+4])*S+r[E+5])*S+r[E+6])*S+r[E+7])*S+r[E+8])*S+r[E+9])*S+r[E+10])*S+r[E+11])*S+r[E+12])*x}else if(x<6.9){E=Math.floor(x);S=x-E;E=13*(E-2);O=(((((((((((a[E]*S+a[E+1])*S+a[E+2])*S+a[E+3])*S+a[E+4])*S+a[E+5])*S+a[E+6])*S+a[E+7])*S+a[E+8])*S+a[E+9])*S+a[E+10])*S+a[E+11])*S+a[E+12];O=O*O;O=O*O;O=O*O;O=1-O*O}else{O=1}if(e<0){O=-O}return O}else{S=n/(n+Math.abs(e));V=S-.5;O=(((((((((d*V+_)*V+q)*V+F)*V+P)*V+T)*V+w)*V+p)*V+b)*V+m)*V+N;O=((((((((((((O*V+g)*V+I)*V+M)*V+c)*V+h)*V+s)*V+l)*V+v)*V+o)*V+u)*V+f)*V+i)*S*Math.exp(-e*e);if(e<0){O=2-O}if(t===1){return O}if(t===2){return Math.exp(e*e)*O}}};e.erf=function(e){return t(e,0)};e.erfc=function(e){return t(e,1)};e.erfcx=function(e){return t(e,2)}})(e);e.lerfc=function(e){var r=1/Math.sqrt(Math.PI);var a,t,n,i,f;if(e<.5){a=e*e;f=a;n=3209.377589138469;i=2844.23683343917;n+=377.485237685302*f;i+=1282.616526077372*f;n+=113.8641541510501*(f*=a);i+=244.024637934441*f;n+=3.161123743870565*(f*=a);i+=23.60129095234412*f;n+=.1857777061846031*(f*=a);i+=f;t=e*n/i;return Math.log(1-t)}else if(e<=4){f=e;n=300.4592610201616;i=300.4592609569832;n+=451.9189537118729*f;i+=790.950925327898*f;n+=339.3208167343436*(f*=e);i+=931.3540948506096*f;n+=152.9892850469404*(f*=e);i+=638.9802644656311*f;n+=43.16222722205673*(f*=e);i+=277.5854447439876*f;n+=7.211758250883093*(f*=e);i+=77.00015293522947*f;n+=.5641955174789739*(f*=e);i+=12.78272731962942*f;n-=1.368648573827167e-7*(f*=e);i+=f;t=n/i;return-(e*e)+Math.log(t)}else{a=1/(e*e);f=a;n=-.0006587491615298378;i=.002335204976268692;n-=.01608378514874227*f;i+=.06051834131244132*f;n-=.1257817261112292*(f*=a);i+=.5279051029514285*f;n-=.3603448999498044*(f*=a);i+=1.872952849923461*f;n-=.3053266349612323*(f*=a);i+=2.568520192289822*f;n-=.01631538713730209*(f*=a);i+=f;t=n/i;t=r+t*a;return Math.log(t)-e*e-Math.log(e)}};e.trunc=i;e.gamma=f;e.gammaln=l;e.betainc=h;e.csqrt=function(e){var r=e[0],a=e[1],t=Math.sqrt(r*r+a*a);return[Math.sqrt((r+t)*.5),(a<0?-1:1)*Math.sqrt((t-r)*.5)]};e.ctimes=function(e,r){var a=e[0],t=e[1],n=r[0],i=r[1];return[a*n-t*i,t*n+a*i]};e.cdivide=function(e,r){var a=e[0],t=e[1],n=r[0],i=r[1];var f=1/(n*n+i*i);return[(a*n+t*i)*f,(t*n-a*i)*f]};e.csquare=function(e){var r=e[0],a=e[1];return[r*r-a*a,a*r+r*a]};e.cinv=function(e){var r=e[0],a=e[1],t=1/(r*r+a*a);return[r*t,-a*t]};e.cplus=function(e,r){var a=e[0],t=e[1],n=r[0],i=r[1];return[a+n,t+i]};e.cminus=function(e,r){var a=e[0],t=e[1],n=r[0],i=r[1];return[a-n,t-i]};e.cabs=function(e){var r=e[0],a=e[1];return Math.sqrt(r*r+a*a)};e.cangle=function(e){var r=e[0],a=e[1];return Math.atan2(a,r)}})(Math);
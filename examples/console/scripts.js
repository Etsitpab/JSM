var MEASURESD65 = [
    {
        "mean": [202.85583224115334,139.58556450102978,113.36154278225051,202.1692566935031],
        "std": [6.205964477734478,5.134792899666524,5.095784359217684,6.345983662971648],
        "min": [175,117,92,173],
        "max": [226,161,132,226],
        "scales": [1.4508129489696207,1.7864307374179142]
    },
    {
        "mean": [575.6203722367802,390.3929315326211,329.88698515084326,573.6307196129812],
        "std": [11.299210645470394,9.234000995504456,8.837259657068657,11.104337227751662],
        "min": [527,357,298,527],
        "max": [631,426,362,620],
        "scales": [1.471915855825031,1.741886075505916]
    },
    {
        "mean": [374.6424571805007,131.76871980676327,354.7201910408432,373.72244180939833],
        "std": [7.800794330270521,4.599625332615028,8.892880730247906,7.7603080334123105],
        "min": [336,111,315,332],
        "max": [405,154,396,405],
        "scales": [2.839691013494569,1.0548665087177556]
    },
    {
        "mean": [234.2813808654569,101.15472994738538,109.18925158380758,233.81949962418125],
        "std": [6.434338596545032,4.373551185865998,4.866408006060893,6.42380287434173],
        "min": [200,82,82,192],
        "max": [271,122,130,261],
        "scales": [2.3137864177637377,2.1435300347779656]
    },
    {
        "mean": [487.8446741314958,232.02285386161356,473.74298018949185,486.5869078380706],
        "std": [12.060518988351458,7.425016243010863,12.605538339852801,11.646259623276583],
        "min": [329,152,362,382],
        "max": [537,260,530,532],
        "scales": [2.0998612114105604,1.0284390721523777]
    },
    {
        "mean": [903.5853677499612,259.95436168558547,596.8116156118799,902.0883221893952],
        "std": [14.156472178811251,7.282369565289558,11.643415614729491,14.082265950148557],
        "min": [847,233,555,841],
        "max": [963,290,637,955],
        "scales": [3.4730590366537433,1.5127668787814166]
    },
    {
        "mean": [452.67903432559467,450.3520865973508,141.85821108104258,450.27075915111806],
        "std": [9.788615511932363,10.761820067273197,5.479310187403922,9.810005421747803],
        "min": [406,394,120,406],
        "max": [495,499,167,488],
        "scales": [1.0024931829437917,3.1825785289258444]
    },
    {
        "mean": [296.5278106508876,101.34372781065089,404.00094674556215,295.611775147929],
        "std": [7.067175033635226,4.4743602567251335,9.2642591561876,7.16949181745955],
        "min": [261,80,368,265],
        "max": [326,120,445,325],
        "scales": [2.921441704340901,0.7328443046591958]
    },
    {
        "mean": [297.4728674203494,352.38006166495376,178.203802672148,296.1263103802672],
        "std": [6.6623648119195495,7.99388565846107,5.937344018208613,6.645732485554838],
        "min": [264,310,144,233],
        "max": [327,385,207,329],
        "scales": [0.8422712326513755,1.6655064844286627]
    },
    {
        "mean": [138.48795309168443,85.53459488272921,153.65767590618336,137.99914712153517],
        "std": [4.7171348091906,4.011428499632133,5.564616357294949,4.727163330909419],
        "min": [114,68,130,112],
        "max": [156,104,179,156],
        "scales": [1.616229670534435,0.899685286083692]
    },
    {
        "mean": [777.0292090754878,327.60347752332484,257.604590754877,775.2744380831213],
        "std": [14.606628539682228,8.654084454680353,7.505341512471019,14.84790485344693],
        "min": [711,296,224,712],
        "max": [839,361,291,831],
        "scales": [2.3691806614722024,3.0129580428085223]
    },
    {
        "mean": [678.264301276066,519.5132275132275,184.30451291627762,675.4872082166199],
        "std": [11.37877760262149,9.917197774587791,6.227850806912387,11.12250582321188],
        "min": [625,471,158,618],
        "max": [733,557,209,728],
        "scales": [1.3029037932034344,3.672594577506745]
    },
    {
        "mean": [180.87114285714287,54.308571428571426,287.55278571428573,180.03485714285713],
        "std": [6.060105294880066,3.5712515339872226,8.841627055041203,6.181892945846294],
        "min": [152,38,250,151],
        "max": [204,71,321,206],
        "scales": [3.3227351641414145,0.6275473894358278]
    },
    {
        "mean": [447.43461538461537,121.17222222222222,183.52277167277168,446.439072039072],
        "std": [8.85082348270113,4.683389029193873,6.143502920282052,8.953189735556318],
        "min": [401,97,157,408],
        "max": [484,146,207,486],
        "scales": [3.6884430731342843,2.4353209121577004]
    },
    {
        "mean": [183.7998244073749,276.32468173836696,88.25246927129061,183.13690737489026],
        "std": [5.437162602811006,6.747106904491988,4.4623541253156445,5.464865434498825],
        "min": [155,234,66,144],
        "max": [207,308,109,206],
        "scales": [0.663959385520423,2.0789034845829137]
    },
    {
        "mean": [879.5251409774436,556.2719689849624,222.58059210526315,877.3096804511279],
        "std": [13.893776406418988,10.367207256012302,6.912649865979664,13.821691103495445],
        "min": [819,509,197,820],
        "max": [950,599,252,934],
        "scales": [1.5791150007381225,3.946513945379673]
    },
    {
        "mean": [355.4745503252966,365.70908279117236,347.64606454904964,353.90132669983416],
        "std": [7.724292202441116,7.91966314944986,9.06257091019828,7.709458888712145],
        "min": [315,323,312,313],
        "max": [399,413,394,389],
        "scales": [0.9698636298707947,1.0202558713634515]
    },
    {
        "mean": [509.3686962388261,111.06333277112498,483.85823916343395,508.3886827458256],
        "std": [8.534191510137962,4.54560388997338,9.462000367791429,8.618063964788128],
        "min": [468,95,450,468],
        "max": [552,129,519,546],
        "scales": [4.581878436342293,1.0517102909566054]
    },
    {
        "mean": [1603.5714528462192,744.6114698385726,1086.0922684791844,1598.493797790994],
        "std": [19.187157971595465,12.50822229896983,16.37751847079025,18.827681966410108],
        "min": [1525,694,1019,1520],
        "max": [1677,788,1146,1672],
        "scales": [2.150158425125658,1.4741221089442746]
    },
    {
        "mean": [1069.9904124860648,490.61664808621333,740.7608324043107,1066.5190635451504],
        "std": [14.948018953744235,9.386465966218097,12.676282939055255,14.616099334611405],
        "min": [1009,449,678,1009],
        "max": [1129,531,792,1145],
        "scales": [2.177371563281907,1.4421047810375442]
    },
    {
        "mean": [657.9720385674931,299.7221074380165,458.5309917355372,656.1420798898072],
        "std": [9.279189485509011,6.68950523085615,9.027397644880324,9.362715273998846],
        "min": [609,271,417,606],
        "max": [701,329,499,699],
        "scales": [2.1922208703424775,1.4329610671280755]
    },
    {
        "mean": [362.9987619047619,167.9664761904762,252.2882857142857,361.6195238095238],
        "std": [7.158532893706641,5.198289295808675,6.885870795016597,7.227785266389076],
        "min": [327,146,213,328],
        "max": [396,190,283,393],
        "scales": [2.157032469064122,1.4360918178636912]
    },
    {
        "mean": [181.45689908796706,81.93056781406295,129.3657938609395,180.72501716191036],
        "std": [5.220428562592004,3.970576882266261,5.130960387845672,5.191572713381568],
        "min": [148,65,102,148],
        "max": [205,98,152,204],
        "scales": [2.2102978528833703,1.3998364847480522]
    },
    {
        "mean": [73.96236669401148,33.182526661197706,54.24087366694012,73.56255127153405],
        "std": [3.8851735796348645,2.811062404715179,3.6549064938038223,3.9368130443801697],
        "min": [49,19,36,54],
        "max": [95,49,71,100],
        "scales": [2.2229307531613487,1.359905436547772]
    }
]
var MEASURESA = [
    {
        "mean": [318.82805325987147,403.5589225589226, 91.60070400979492, 317.822237526783],
        "std": [12.337814865148218,13.641042148209703,4.742795090127761,12.238854137805117],
        "min": [270,355,70,270],
        "max": [359,456,110,357],
        "scales": [0.7887947152174524,3.4751386338612478]
    },
    {
        "mean": [1011.3015592077539,1299.9683101559208,314.3292878213232,1006.7365360303413],
        "std": [25.337983417611884,29.238774616083383,9.219875736925992,25.54665388888166],
        "min": [917,1193,280,922],
        "max": [1098,1382,351,1096],
        "scales": [0.7761874191364125,3.210070097548825]
    },
    {
        "mean": [569.016472251679,402.49883351007423,265.5256981265465,567.3289501590668],
        "std": [18.743907686637584,13.9768570602575,9.511569033037368,18.755049084338776],
        "min": [511,360,234,509],
        "max": [640,452,298,634],
        "scales": [1.411613311398956,2.1398030970794713]
    },
    {
        "mean": [399.0529810298103,325.3193089430894,106.17439024390244,398.1237127371274],
        "std": [15.985189823955546,13.315713472546637,5.440318696450704,15.830771538302674],
        "min": [351,274,82,346],
        "max": [455,371,127,457],
        "scales": [1.2252219155955386,3.754091226404379]
    },
    {
        "mean": [691.531606557377,684.9748852459016,325.42996721311476,688.6073442622951],
        "std": [22.67420775681328,21.477840167793495,11.2389195510585,22.722533180988037],
        "min": [620,619,282,624],
        "max": [757,781,368,755],
        "scales": [1.0074376305959094,2.120485342266987]
    },
    {
        "mean": [1090.2292966773487,579.6636026311351,402.85798616967446,1086.2187552707032],
        "std": [34.66437781559802,19.774713930448872,13.784706017504043,34.533267422817616],
        "min": [980,523,348,995],
        "max": [1200,643,447,1183],
        "scales": [1.8773371676857034,2.701259658076361]
    },
    {
        "mean": [737.8531746031746,1174.2464726631392,145.4353615520282,733.0929453262787],
        "std": [23.40925767114801,34.247090753167484,5.964231953377429,23.200932594866696],
        "min": [663,1070,123,648],
        "max": [814,1288,168,804],
        "scales": [0.6263361884295945,5.057044257435408]
    },
    {
        "mean": [332.5193328795099,245.25534377127298,220.99720898570456,332.03247106875426],
        "std": [12.574248164181661,10.225669357416118,8.828934869112581,12.605622949874473],
        "min": [288,212,189,289],
        "max": [377,287,254,373],
        "scales": [1.3548161555412026,1.5035298567758189]
    },
    {
        "mean": [550.6661830357143,1080.4550223214285,161.38604910714287,548.03046875],
        "std": [19.8572295563122,33.28340455216573,6.922075950050786,19.70443380123216],
        "min": [484,983,132,474],
        "max": [619,1180,191,608],
        "scales": [0.5084416422189849,3.403939367325049]
    },
    {
        "mean": [192.08421180176904,242.8747728098873,92.1992608748334,191.2720828789531],
        "std": [8.71879494963949,9.965995366304563,4.5883011211768645,8.724345958740557],
        "min": [162,205,72,159],
        "max": [226,280,110,239],
        "scales": [0.789205668101228,2.078955357359934]
    },
    {
        "mean": [1045.0813802083333,795.8641276041667,231.3380859375,1040.1458984375],
        "std": [33.35119174291406,25.587304775141224,8.812001208888697,32.9153007284738],
        "min": [954,717,199,938],
        "max": [1150,875,261,1131],
        "scales": [1.3100397456806523,4.506882794926369]
    },
    {
        "mean": [973.483115942029,1234.5877536231885,177.59202898550726,966.1441304347826],
        "std": [31.330773504033857,38.7388847373315,7.360840891861039,31.158367299714307],
        "min": [875,1096,154,845],
        "max": [1076,1338,206,1047],
        "scales": [0.7855364030157106,5.46090738829021]
    },
    {
        "mean": [151.95617361989042,98.65933417614833,119.5433628318584,151.46986936367466],
        "std": [5.171153668819836,4.55324597949228,4.436902541841174,5.252760555229038],
        "min": [115,81,99,128],
        "max": [174,118,137,175],
        "scales": [1.5377462533946469,1.2691045148627098]
    },
    {
        "mean": [499.53472900390625,243.5643310546875,130.0726318359375,498.3843994140625],
        "std": [15.068688968940762,8.867978475564696,5.184831124620556,14.892544882920532],
        "min": [438,204,110,440],
        "max": [552,273,151,549],
        "scales": [2.0485740340072742,3.836007291974605]
    },
    {
        "mean": [319.47079513348325,759.1545292048665,88.19673643544947,318.88687078360147],
        "std": [12.839581714132501,26.700282357037082,4.5761331929429465,12.782636834120698],
        "min": [276,666,65,273],
        "max": [363,840,112,361],
        "scales": [0.42043987183063786,3.6189415375040204]
    },
    {
        "mean": [1233.7105413105412,1351.4019230769231,231.2514245014245,1227.1289173789173],
        "std": [42.31975571481229,46.66063007543678,9.165059959556066,42.29175329614391],
        "min": [1128,1225,191,1114],
        "max": [1349,1514,265,1333],
        "scales": [0.9104765268819973,5.320701189181863]
    },
    {
        "mean": [473.5703125,899.419125,197.318,471.2890625],
        "std": [16.24074093927013,31.259505058867802,7.2854868330743345,16.026612512954316],
        "min": [411,804,171,404],
        "max": [539,999,229,533],
        "scales": [0.5252608871309024,2.3942554024468117]
    },
    {
        "mean": [433.5363041791376,179.83870967741936,234.1995344196874,432.701585190112],
        "std": [11.140382986233956,6.0857538069810975,6.90835509158728,11.253551631203383],
        "min": [389,160,205,387],
        "max": [468,203,267,467],
        "scales": [2.408374400936927,1.849358692184555]
    },
    {
        "mean": [1577.095045045045,1399.1654054054054,547.478018018018,1570.5975675675675],
        "std": [50.04674157911303,45.541805734145115,18.138343825965407,49.870407184803774],
        "min": [1438,1263,487,1395],
        "max": [1701,1511,617,1695],
        "scales": [1.1248464979380244,2.874720544952564]
    },
    {
        "mean": [1115.806967984934,975.4772441933459,391.995919648462,1111.844789704959],
        "std": [33.650433208560834,30.24985208283173,12.960826858916283,33.618032274588316],
        "min": [1009,892,353,986],
        "max": [1206,1062,433,1208],
        "scales": [1.1418266140754578,2.8414221246073543]
    },
    {
        "mean": [699.0822095238095,608.1588571428572,247.59550476190475,696.7596952380952],
        "std": [20.105801179739935,17.554386648840115,8.041588101483331,19.813562754648153],
        "min": [635,535,215,632],
        "max": [761,684,272,760],
        "scales": [1.147596461325581,2.8187949254252174]
    },
    {
        "mean": [376.7872888173773,333.5209171359614,132.64424778761062,375.5711987127916],
        "std": [12.739426655956555,11.705872064363344,5.427221386212466,12.532177553192053],
        "min": [328,294,111,332],
        "max": [414,373,155,415],
        "scales": [1.1279030022927565,2.8360011839142922]
    },
    {
        "mean": [178.67901960784314,155.93676470588235,64.14941176470589,177.95813725490197],
        "std": [6.462568503734766,6.213906177823435,3.388790350012181,6.4923580667408585],
        "min": [151,136,51,153],
        "max": [202,179,81,205],
        "scales": [1.1435313459767187,2.779738325355634]
    },
    {
        "mean": [66.16867346938776,60.15714285714286,23.516938775510205,65.73051020408164],
        "std": [3.6959415516164,3.5619400729625363,2.3090001291499496,3.7182822327551],
        "min": [46,43,7,44],
        "max": [88,84,33,88],
        "scales": [1.0962886318146352,2.804344241666884]
    }];
var MEASURESH = [
    {
        "mean": [292.21492673992674,410.72957875457877,73.99102564102564, 291.1925824175824],
        "std": [8.959436664895136,11.231393201506357,4.037500744792834,9.058944458007788],
        "min": [258,353,52,258],
        "max": [329,461,90,326],
        "scales": [0.7102087837532025,3.942420746996839]
    },
    {
        "mean": [875.322300295858,1274.0302329881656,233.1935096153846,871.8395894970414],
        "std": [17.54023302283861,22.235916421092014,6.948845411600554,17.528658754787184],
        "min": [793,1176,189,792],
        "max": [934,1388,262,949],
        "scales": [0.6856830570240984,3.746163202986574]
    },
    {
        "mean": [458.51523656776266,391.651764234162,167.12336273723602,457.692395081529],
        "std": [13.771314492737647,12.295011274515794,6.458429069625842,13.428395290485874],
        "min": [416,344,139,409],
        "max": [506,435,192,513],
        "scales": [1.1696712683534685,2.741111765115158]
    },
    {
        "mean": [337.11444978632477,320.6718082264957,79.7477297008547,336.72222222222223],
        "std": [12.147968723670092,11.854690434776892,4.393202541229896,12.348842840341755],
        "min": [294,282,61,290],
        "max": [382,362,101,398],
        "scales": [1.050664035194209,4.224801599595412]
    },
    {
        "mean": [566.4030567134015,673.1122900088417,209.43513957307061,564.099658961728],
        "std": [13.053698546145762,15.2855140456243,6.695744126693714,12.809771414575739],
        "min": [517,615,181,516],
        "max": [617,726,233,605],
        "scales": [0.8397578921492279,2.6989327530700837]
    },
    {
        "mean": [852.2266521686602,543.8083846804398,258.34009906971124,848.5518907816842],
        "std": [19.704035354399156,14.029555637306451,7.9068374788661036,19.639713279795473],
        "min": [785,496,226,783],
        "max": [916,599,291,912],
        "scales": [1.563766384320995,3.2917432273868585]
    },
    {
        "mean": [710.6682555896039,1196.3840653728294,135.03450232663715,706.3432073544433],
        "std": [19.76997491608332,29.384449860741377,5.405860435488516,19.338375687458964],
        "min": [647,1103,116,630],
        "max": [782,1282,162,788],
        "scales": [0.592205924483984,5.246849651492828]
    },
    {
        "mean": [276.8714248228811,251.91830665617073,139.870025365171,276.3230123327211],
        "std": [9.376452509309956,9.159784556174932,5.7246478992193195,9.541042954108327],
        "min": [237,219,120,241],
        "max": [316,285,166,317],
        "scales": [1.0979639481116124,1.9775303382956024]
    },
    {
        "mean": [536.1423854180425,1109.547880068683,138.17408532558446,533.959450534936],
        "std": [18.231160344820935,31.471805243094007,6.129198714575435,17.856432907992538],
        "min": [466,981,108,471],
        "max": [602,1205,164,591],
        "scales": [0.48222427133416595,3.872295710991898]
    },
    {
        "mean": [176.73272490221643,255.29153991018399,66.15377372157033,176.09952194697956],
        "std": [7.526429370692181,9.449143509596075,4.003190853249392,7.4971696064287245],
        "min": [148,198,48,110],
        "max": [210,305,83,204],
        "scales": [0.6910378757034575,2.666758273943715]
    },
    {
        "mean": [890.7871538350007,777.9317094388865,180.29570827896185,886.2414818036827],
        "std": [25.01600891570403,22.29097087951763,7.055028116924623,24.754707051680587],
        "min": [794,699,154,788],
        "max": [981,849,209,971],
        "scales": [1.1421495062339304,4.928094663488003]
    },
    {
        "mean": [896.9565348172657,1237.0039103624606,158.07565047375545,889.4129944352534],
        "std": [26.37476830576912,35.5928377805923,6.798875237235498,26.202295019947595],
        "min": [802,1113,125,793],
        "max": [982,1346,187,965],
        "scales": [0.7220549241146239,5.6503627342311695]
    },
    {
        "mean": [128.5483898817232,106.28481395148061,75.17482517482517,128.26987826987826],
        "std": [5.806815045545324,5.444175165924661,4.432371178649596,5.856294077773368],
        "min": [97,83,51,97],
        "max": [153,128,94,149],
        "scales": [1.2081606892064558,1.7081401091013495]
    },
    {
        "mean": [419.26377952755905,242.5088922074396,98.10426282921532,418.8649199022536],
        "std": [13.397128786475061,8.838629163843596,4.7111231612125986,13.48829483376621],
        "min": [375,208,82,372],
        "max": [470,278,121,472],
        "scales": [1.7280370459836294,4.271622227511499]
    },
    {
        "mean": [321.99221364660883,790.3035994809097,84.07356054914281,321.9329280786832],
        "std": [13.965069402343646,29.11753961805451,5.087538182672457,13.771263080866486],
        "min": [268,708,64,283],
        "max": [377,884,105,371],
        "scales": [0.4073909964146926,3.8295341455706744]
    },
    {
        "mean": [1107.2125984251968,1346.8425196850394,199.73006096012193,1101.7093599187199],
        "std": [41.47987384245132,49.59584768406567,9.07869914979337,41.39095704805373],
        "min": [1000,1209,163,988],
        "max": [1220,1793,237,1214],
        "scales": [0.8200372077874686,5.529768397719935]
    },
    {
        "mean": [447.77552065551384,930.5328610447251,148.5527483782861,445.68564356435644],
        "std": [15.554817140141893,30.846780837703545,6.533778422797152,15.263286789657684],
        "min": [390,844,115,385],
        "max": [498,1026,178,497],
        "scales": [0.4800803935160152,3.0072185603213892]
    },
    {
        "mean": [335.8143573218761,175.89607948442534,147.00957751521662,335.29940923737917],
        "std": [10.923358204378133,7.136922872940352,6.009659928927913,11.248845318560235],
        "min": [293,147,121,297],
        "max": [382,206,170,378],
        "scales": [1.9076996159504476,2.282551170823513]
    },
    {
        "mean": [1372.9964953271028,1412.6389288281812,384.63605319913734,1367.949137311287],
        "std": [35.21389259407956,37.026143627803826,11.331258230680495,35.15287417736485],
        "min": [1246,1279,342,1249],
        "max": [1492,1528,440,1467],
        "scales": [0.9701508208159292,3.5630378507697014]
    },
    {
        "mean": [959.4111229783339,974.6805004577358,272.1763808361306,956.0389838266707],
        "std": [24.558252455301744,26.233517622578333,8.870980854903078,24.6872789924304],
        "min": [883,894,238,867],
        "max": [1036,1053,304,1045],
        "scales": [0.9826040973967666,3.5187662149829246]
    },
    {
        "mean": [603.0131598736652,609.6209204391638,172.90765528650925,601.0231613776508],
        "std": [14.467392980568514,14.868120113462279,6.0225604326554585,14.297268528122734],
        "min": [549,548,148,540],
        "max": [658,685,198,654],
        "scales": [0.9875287091393964,3.4817322554522505]
    },
    {
        "mean": [328.3621199484419,337.1891727955114,94.41799984835848,327.77276518310714],
        "std": [10.271719832783178,10.895542485930648,4.557476490901532,10.048192855048232],
        "min": [281,291,68,283],
        "max": [371,385,111,371],
        "scales": [0.9729477368620351,3.474628175693961]
    },
    {
        "mean": [157.17709815078237,160.54812707444287,46.071676940097994,156.58368895211],
        "std": [5.813414606021146,6.372708338791363,3.178704791578802,5.898901098822581],
        "min": [123,137,23,113],
        "max": [182,190,59,181],
        "scales": [0.9771549279967867,3.4051374721050585]
    },
    {
        "mean": [60.82890199132273,65.39770831015686,19.091667593725663,60.38213371898988],
        "std": [3.8950239737349395,3.936427290336218,2.3815150469535014,3.993909062427432],
        "min": [40,48,0,36],
        "max": [87,81,34,81],
        "scales": [0.9267223488585719,3.174448620458585]
    }]
var MEASURESTL84 = [
    {
        "mean": [261.3019001414999, 249.8696179502729, 94.06599959571457, 260.4000404285425],
        "std": [6.84658252968061,6.6648994123147975,4.150434868674627,6.813679226498685],
        "min": [233,217,75,237],
        "max": [300,277,109,294],
        "scales": [1.0439483296321914,2.773063289670341]
    },
    {
        "mean": [760.6549145299145,758.9081196581196,285.64346764346766,757.914072039072],
        "std": [12.179436140291362,12.507561251428875,6.628774073464373,12.290752613049808],
        "min": [697,701,259,694],
        "max": [815,811,315,812],
        "scales": [1.0004959409665337,2.658154585324567]
    },
    {
        "mean": [473.03078654661016,257.30528336864404,300.4860963983051,472.12877383474574],
        "std": [10.24736974327331,7.633494194771494,7.13107426022588,10.246652023916363],
        "min": [434,224,267,431],
        "max": [602,290,338,523],
        "scales": [1.8366501223902498,1.5727176260570024]
    },
    {
        "mean": [344.6377570093458,199.54915887850467,104.78198130841122,344.2338691588785],
        "std": [8.990956079031031,6.858704653413678,4.6269076148348685,8.951685853652322],
        "min": [301,171,84,305],
        "max": [378,228,125,379],
        "scales": [1.7260699820530019,3.2871664458253864]
    },
    {
        "mean": [574.9709917355372,395.79809917355374,365.33355371900825,573.1596694214876],
        "std": [11.59346220175642,9.389276082544537,7.944991145600397,11.584307263759662],
        "min": [533,360,334,527],
        "max": [621,445,395,619],
        "scales": [1.4503994126732533,1.5713457598807024]
    },
    {
        "mean": [933.2812865497076,402.92894736842106,423.02933723196884,931.2788499025341],
        "std": [15.700177866794395,9.676476353633934,9.037661340006888,15.991191924508614],
        "min": [874,371,386,868],
        "max": [996,436,459,993],
        "scales": [2.3137579821826098,2.203818946284814]
    },
    {
        "mean": [593.0420918367347,781.2526421282798,128.12399781341108,589.8381924198251],
        "std": [13.813177669116639,17.752098078390915,4.847451848995953,13.855290609742573],
        "min": [532,706,110,532],
        "max": [640,842,151,636],
        "scales": [0.7570408216695244,4.616154289765475]
    },
    {
        "mean": [303.12916666666666,160.84047619047618,292.75912698412696,302.5119708994709],
        "std": [8.597505846823386,6.302288927734746,7.620143553029699,8.521302460648151],
        "min": [258,136,256,257],
        "max": [356,207,335,356],
        "scales": [1.8827385739921083,1.0343676451784451]
    },
    {
        "mean": [429.8553276353276,655.7232478632478,156.17321937321938,427.82940170940174],
        "std": [12.38844041269129,15.823533987985325,5.82724404950208,12.444296601462948],
        "min": [378,583,126,374],
        "max": [470,711,187,467],
        "scales": [0.6539990248474468,2.7459404781016037]
    },
    {
        "mean": [167.62434782608696,146.7804743083004,119.85130434782609,166.91106719367588],
        "std": [6.174287001383867,5.554289922638077,4.872274083597129,6.140957309398478],
        "min": [136,121,99,137],
        "max": [195,179,140,194],
        "scales": [1.1395773742940034,1.3956269263824277]
    },
    {
        "mean": [912.6247933884298,540.4187567373339,212.5588214157384,909.9159180740209],
        "std": [18.407068871462698,12.497057018773766,6.510562423892938,18.531718249951172],
        "min": [854,484,189,838],
        "max": [991,587,241,971],
        "scales": [1.6862300657971812,4.287144375668581]
    },
    {
        "mean": [857.8178145440554,827.7562524047711,166.01221623701423,853.0621392843401],
        "std": [17.24632658671374,16.794998979627444,5.638709138126109,17.35835650210832],
        "min": [784,749,136,787],
        "max": [917,898,189,912],
        "scales": [1.0334442952608343,5.152873663784438]
    },
    {
        "mean": [154.94083333333333,74.78037037037036,177.92712962962963,154.36666666666667],
        "std": [5.0968506106089695,3.7853441468481215,5.668412981931324,5.158798787157894],
        "min": [131,55,149,131],
        "max": [174,92,205,174],
        "scales": [2.068106232077145,0.8691971276214305]
    },
    {
        "mean": [499.0173935617861,185.51903772931811,139.17229145032883,498.66329179646937],
        "std": [10.435615811246533,5.676424265749507,4.776601411998291,10.545120003876425],
        "min": [463,154,114,455],
        "max": [668,211,162,538],
        "scales": [2.6888903089663585,3.5843366339711804]
    },
    {
        "mean": [250.9859571322986,443.6813814419136,73.61573607471612,249.71800040314452],
        "std": [8.980051003312012,13.039196155929043,4.069822950740442,8.845230518333414],
        "min": [201,380,56,207],
        "max": [295,491,91,284],
        "scales": [0.5642607268173083,3.4007943425795184]
    },
    {
        "mean": [1091.9862904395764,907.5325692731757,202.19251414478455,1087.9745393877847],
        "std": [30.050211165139892,24.40742895225212,7.657366427593622,29.542258161635093],
        "min": [1001,817,178,991],
        "max": [1205,996,228,1172],
        "scales": [1.2010372429791953,5.390804993567542]
    },
    {
        "mean": [387.30609567901234,539.3840277777778,235.77538580246915,385.26381172839507],
        "std": [9.984990350002025,12.952076463830112,7.3316228053671875,9.827115108193686],
        "min": [347,489,205,343],
        "max": [430,584,263,424],
        "scales": [0.716159422249059,1.6383599687005934]
    },
    {
        "mean": [413.2834422657952,137.26307189542484,287.99727668845316,412.63289760348584],
        "std": [9.430201170111346,4.643537968002839,7.9634400738571625,9.462760452257745],
        "min": [380,117,250,376],
        "max": [452,155,323,449],
        "scales": [3.0085161597523955,1.433896093334821]
    },
    {
        "mean": [1511.3893684210527,1045.9872631578946,680.9177894736843,1506.6288421052632],
        "std": [26.606316270816954,18.104891010938466,13.32448610842384,26.3276769395894],
        "min": [1424,980,630,1405],
        "max": [1595,1110,759,1596],
        "scales": [1.4426648950842615,2.2161399343517623]
    },
    {
        "mean": [1052.0718960107574,714.0458090542357,482.91743612729715,1048.934289556253],
        "std": [19.794393977558304,14.108253540543336,10.57308452776048,20.01960853861816],
        "min": [968,628,439,963],
        "max": [1126,773,522,1118],
        "scales": [1.471198457385965,2.1753264930914447]
    },
    {
        "mean": [661.4659013605442,446.88647959183675,305.65085034013606,659.6199829931973],
        "std": [11.724958121447887,9.257039714296097,6.993347777000539,11.7943035425496],
        "min": [607,411,276,615],
        "max": [707,488,339,703],
        "scales": [1.4781000821062584,2.1611029102055554]
    },
    {
        "mean": [360.21881149153876,248.0340023612751,165.53561589925226,359.17087760724127],
        "std": [7.867235607246742,6.527066002409171,4.947807997834694,7.917016996110908],
        "min": [320,210,141,327],
        "max": [396,278,188,394],
        "scales": [1.4501836083968633,2.172915131256746]
    },
    {
        "mean": [175.23979591836735,118.81969387755102,81.96183673469388,174.56826530612244],
        "std": [5.118799700884719,4.372146471704522,3.4457545627129655,5.265308623094883],
        "min": [146,98,65,148],
        "max": [197,139,96,200],
        "scales": [1.4720121295085247,2.1339691444251057]
    },
    {
        "mean": [69.42684210526316,47.01568421052632,32.30189473684211,69.114],
        "std": [3.681471509223476,3.2269437425746927,2.4299896197371527,3.609177835589455],
        "min": [54,25,17,50],
        "max": [105,73,43,104],
        "scales": [1.4733470801457071,2.1444692832097187]
    }
]
var MEASURESCW = [
    {
        "mean": [276.6558660933661, 202.77349508599508,97.67183660933661, 275.51796683046683],
        "std": [6.2614637107825,5.009327887162115,3.9040424377665675,6.295760420727716],
        "min": [251,174,80,250],
        "max": [298,222,121,304],
        "scales": [1.361553275712043,2.826678867176384]
    },
    {
        "mean": [756.5266666666666,579.611948051948,281.02614718614717,753.298961038961],
        "std": [10.301941214371608,8.680555487304552,5.999134808964128,10.448612083009232],
        "min": [705,533,253,700],
        "max": [803,629,317,793],
        "scales": [1.30244522458525,2.6862725102684903]
    },
    {
        "mean": [470.7564150943396,216.1593396226415,301.8598113207547,469.4865094339623],
        "std": [8.742174340872333,5.628813666697548,6.665484938352345,8.75240492794637],
        "min": [428,187,268,425],
        "max": [512,242,332,500],
        "scales": [2.174883875408122,1.5574165378530707]
    },
    {
        "mean": [340.14724846303795,168.7591093117409,108.43739691108112,339.72342180236916],
        "std": [9.53253488142306,6.133203234556055,4.720263735945137,9.581795487060875],
        "min": [302,145,84,300],
        "max": [392,194,131,378],
        "scales": [2.0143228802230566,3.1348533330383357]
    },
    {
        "mean": [531.8029564652371,302.17316439246264,356.52217348927877,530.0406107862249],
        "std": [10.557846167668865,7.262145348152406,7.736890262339103,10.885495162048903],
        "min": [491,267,316,477],
        "max": [570,335,386,573],
        "scales": [1.757011694579766,1.4891690422214279]
    },
    {
        "mean": [899.2616413916146,341.81980374665477,400.21935771632474,896.3977698483496],
        "std": [14.636840359471885,7.4419513079018405,8.534091940816644,14.639515097434296],
        "min": [834,307,356,828],
        "max": [958,372,438,964],
        "scales": [2.6266169946239364,2.2433440269932254]
    },
    {
        "mean": [640.967206676485,616.6551791850761,131.1014236622484,636.7478645066274],
        "std": [11.893061767600821,10.969468578618088,4.413747774668514,11.991603651539188],
        "min": [571,576,111,588],
        "max": [696,665,153,681],
        "scales": [1.036004491903921,4.87300227370086]
    },
    {
        "mean": [303.06569821930646,137.1974695407685,297.21227741330836,302.27985004686036],
        "std": [7.2259630302229985,4.5940146530511745,7.128838511213997,7.267877417498565],
        "min": [270,118,264,271],
        "max": [338,157,335,339],
        "scales": [2.2061104708869546,1.0183723793892323]
    },
    {
        "mean": [417.80035612535613,488.0880341880342,158.4616809116809,415.7903133903134],
        "std": [10.046155319991735,9.89307890232588,5.337003731269674,9.902813883766207],
        "min": [364,432,133,363],
        "max": [462,526,178,450],
        "scales": [0.8539347526746903,2.630259456796605]
    },
    {
        "mean": [176.0027402052239,121.06757229477611,125.31010960820896,175.34631529850745],
        "std": [6.276056970529492,4.532616741413041,4.737352869976884,6.343191069781034],
        "min": [149,96,102,140],
        "max": [199,141,144,197],
        "scales": [1.4510452668872569,1.4019182354969177]
    },
    {
        "mean": [938.7174957603165,460.8097795364613,211.34631147540983,934.2647682306388],
        "std": [15.28052654254923,8.886965674189481,6.013069220104262,15.591611895170802],
        "min": [846,424,188,839],
        "max": [1023,490,239,988],
        "scales": [2.0322726938163393,4.431073934803156]
    },
    {
        "mean": [873.1135547183037,661.8893367212828,161.3557346885131,867.2217646543415],
        "std": [14.937411287304554,11.904991163608393,5.117115233308372,15.22388046534304],
        "min": [813,604,140,811],
        "max": [940,717,191,930],
        "scales": [1.3146724254491873,5.392852391432665]
    },
    {
        "mean": [160.81591468416735,67.41369975389664,187.3560295324036,160.2391304347826],
        "std": [4.797438542422552,3.364730857775997,5.411879803580192,4.860207887093717],
        "min": [137,51,160,139],
        "max": [184,82,212,182],
        "scales": [2.3812299747010424,0.856804678024581]
    },
    {
        "mean": [498.7048582995951,169.08225371120108,141.46477732793522,497.41767881241566],
        "std": [10.167896995305163,5.016355816552068,4.592090402912294,10.056204050481904],
        "min": [452,149,110,457],
        "max": [687,192,166,551],
        "scales": [2.945674413630144,3.520744018148273]
    },
    {
        "mean": [234.67861803268502,321.66457465979,75.7022307835705,233.6579879450693],
        "std": [7.906699492964887,9.412190089069387,4.02449535756979,7.905495928423788],
        "min": [206,283,57,202],
        "max": [277,360,93,264],
        "scales": [0.7279890962085157,3.0932814074971513]
    },
    {
        "mean": [1160.6523171018584,756.7422567239081,209.22394730651612,1154.235630831961],
        "std": [25.71226629185091,17.24691023428567,6.746498734650933,25.63010350891165],
        "min": [1083,696,177,1038],
        "max": [1248,816,237,1245],
        "scales": [1.5295088435760429,5.532081718500595]
    },
    {
        "mean": [373.2639030258166,404.3535671324142,242.77394281484223,371.5217914314796],
        "std": [7.7845392490883345,8.66671660309852,6.016855391037359,7.879956146854755],
        "min": [325,372,219,336],
        "max": [413,440,271,404],
        "scales": [0.9209584816317451,1.5339078111552649]
    },
    {
        "mean": [402.7046010483401,123.07513104251602,288.0248107163658,401.540361094933],
        "std": [8.158515670299382,3.754285225973855,7.20301818889292,8.128068743590786],
        "min": [369,107,251,367],
        "max": [443,140,316,440],
        "scales": [3.267292731402612,1.3961383398586076]
    },
    {
        "mean": [1601.150283171521,894.5347896440129,710.1401699029126,1593.0514765372168],
        "std": [23.87251778111348,13.344681076501061,12.744097785722579,23.315421076228358],
        "min": [1460,820,648,1464],
        "max": [1697,950,768,1668],
        "scales": [1.7853982856160884,2.2489938571883883]
    },
    {
        "mean": [1118.3504793079262,611.8786532616319,507.0761047463175,1113.1934767360299],
        "std": [15.329016656985997,9.751741501082625,9.387045359364361,15.64512324800681],
        "min": [1054,552,470,1050],
        "max": [1180,649,548,1177],
        "scales": [1.8235183922078868,2.2004033863519994]
    },
    {
        "mean": [705.3213315217391,383.7326766304348,321.7086730072464,701.9866394927536],
        "std": [10.477643135642348,6.800669479560487,6.551499041831912,10.345128143537433],
        "min": [655,357,296,660],
        "max": [759,411,348,750],
        "scales": [1.8337087987555496,2.187239712655794]
    },
    {
        "mean": [387.25004953437684,213.81553398058253,175.63582326134338,385.7975034674064],
        "std": [7.430705513098666,5.234693276570943,4.88901175865746,7.395710375717541],
        "min": [354,189,158,346],
        "max": [431,233,201,419],
        "scales": [1.8077441302089559,2.200711502492007]
    },
    {
        "mean": [191.94468313641246,103.92932330827068,88.33276047261009,191.1],
        "std": [4.969306497899578,3.643200155518579,3.6032282236244417,5.0162042717526365],
        "min": [167,87,69,166],
        "max": [221,120,103,217],
        "scales": [1.842813322281729,2.168191512905258]
    },
    {
        "mean": [80.6846120782291,43.39060820975715,36.686653771760156,80.27724049000645],
        "std": [3.5820817504355054,2.7086570699863626,2.7477171883731835,3.5992822667382387],
        "min": [66,33,24,60],
        "max": [106,68,57,104],
        "scales": [1.8548006032794029,2.1937385400373746]
    }
]

var gretagAmba = Matrix.toMatrix([
    136, 95, 70, 
    216, 170, 146, 
    104, 139, 177, 
    110, 129, 55,
    145, 141, 192, 
    118, 206, 189, 
    236, 147,  19, 
    51, 83, 178,
    211, 84, 95,
    110, 58, 120, 
    177, 196, 43, 
    228, 170, 8,
    30, 54, 166,
    63, 150, 56, 
    188, 42, 36, 
    251, 220, 23,
    186, 76, 144,
    5, 138, 171, 
    240, 240, 238, 
    188, 189, 184,
    153, 154, 150,
    142, 141, 141, 
    72, 71, 73,
    34, 34, 36
]).reshape(3, 24).transpose()['/='](255).display();

var gretagAmba = Matrix.toMatrix([
    136.17,
    95.06,
    70.167,
    216.543,
    169.93,
    146.66,
    104.096,
    139.255,
    177.153,
    109.951,
    128.715,
    54.997,
    144.875,
    141.024,
    191.352,
    117.694,
    206.208,
    188.767,
    235.931,
    147.267,
    18.648,
    50.642,
    82.761,
    177.897,
    211.345,
    83.924,
    94.742,
    109.968,
    58.529,
    120.118,
    176.614,
    195.575,
    42.918,
    229.059,
    171.781,
    7.58,
    29.828,
    54.138,
    166.404,
    63.016,
    148.688,
    55.357,
    187.664,
    41.681,
    35.076,
    250.725,
    220.094,
    22.4,
    185.935,
    75.892,
    144.222,
    4.636,
    139.456,
    173.001,
    240.166,
    240.669,
    238.449,
    187.251,
    187.968,
    182.913,
    155.282,
    155.533,
    152.213,
    142.22,
    140.803,
    140.474,
    72.232,
    71.385,
    73.438,
    34.546,
    34.395,
    36.031
]).reshape(3, 24).transpose()['/='](255).display();

var R = gretagAmba.get([], 0);
var G = gretagAmba.get([], 1);
var B = gretagAmba.get([], 2);

//var scaleR = G.get(20)['./'](R.get(20))['+'](G.get(21)['./'](R.get(21)))['.*'](0.5);//.display();
//var scaleB = G.get(20)['./'](B.get(20))['+'](G.get(21)['./'](B.get(21)))['.*'](0.5);//.display();
var scaleR = G.get(18)['./'](R.get(18))['+'](G.get(19)['./'](R.get(19)))['.*'](0.5);//.display();
var scaleB = G.get(18)['./'](B.get(18))['+'](G.get(19)['./'](B.get(19)))['.*'](0.5);//.display();

R['*='](scaleR);
B['*='](scaleB);
gretagAmba = R.cat(1, G, B);//.display();
gretagAmba['/='](gretagAmba.max());
    
var getGretag = function (MEASURES) {
    var gretag = []
    var concat = function(v, i, t) {
        gretag = gretag.concat(Array.prototype.slice.call(t[i].mean));
    };
    MEASURES.forEach(concat);
    gretag = Matrix.toMatrix(gretag).reshape(4, 24).transpose();//.display();

    var Gr = gretag.get([], 0);
    var R  = gretag.get([], 1);
    var B  = gretag.get([], 2);
    var Gb = gretag.get([], 3);
    var G  = Gr['+'](Gb)['/='](2);
    
    var scaleR = G.get(20)['./'](R.get(20))['+'](G.get(21)['./'](R.get(21)))['.*'](0.5);//.display();
    var scaleB = G.get(20)['./'](B.get(20))['+'](G.get(21)['./'](B.get(21)))['.*'](0.5);//.display();
    // var scaleR = G.get(18)['./'](R.get(18))['+'](G.get(19)['./'](R.get(19)))['.*'](0.5);//.display();
    // var scaleB = G.get(18)['./'](B.get(18))['+'](G.get(19)['./'](B.get(19)))['.*'](0.5);//.display();
    
    R['*='](scaleR);
    B['*='](scaleB);
    gretag = R.cat(1, G, B);//.display();
    gretag['/='](gretag.max());
    return gretag;
};

var RGB2YCbCr = function (Kb, Kr) {
    var Pbc = 0.5 / (1 - Kb),
        Prc = 0.5 / (1 - Kr);
    return Matrix.toMatrix([
               Kr,               (1 - Kr - Kb),            Kb,
        -Pbc * Kr,        -Pbc * (1 - Kr - Kb),  Pbc * (1 - Kb),
         Prc * (1 -  Kr), -Prc * (1 - Kr - Kb), -Prc *      Kb
    ]).reshape(3, 3).transpose();
};

var noiseModelEstimate = function (BUFFERS) {
    var data = BUFFERS[0].cat(2, BUFFERS[1], BUFFERS[2], BUFFERS[3], BUFFERS[4], BUFFERS[5], BUFFERS[6], BUFFERS[7], BUFFERS[8], BUFFERS[9]);
    data.reshape(1500 * 2000 * 4, 10);
    var mean = data.mean(1), std = data.std(1);
    var image = mean.getCopy().reshape(1500, 2000, 4)
    mean.reshape(1500 * 2000, 4);
    std.reshape(1500 * 2000, 4);
    var order = mean.asort(0, 'ascend');
    std = std.get(order);
    mean = mean.get(order);
    return {
        image: image,
        mean: mean,
        std: std
    }
};


var saturateCM = function (M, s1, s2) {
    var O = Matrix.toMatrix([
        0.33, 0.34, 0.33,
        0.50, 0.00, -0.5,
       -0.25, 0.5, -0.25
    ]).reshape(3, 3).transpose();
    var S = Matrix.toMatrix([
        1.00, 0.00, 0.00,
        0.00,   s1, 0.00,
        0.00, 0.00,   s2
    ]).reshape(3, 3).transpose();
    return O.inv().mtimes(S).mtimes(O).mtimes(M);
};
var getsRGBPatches = function () {
    var sRGBPatches = [
        38.442,	 13.605, 14.529,
        65.946,	 17.907, 17.871,
        50.063,	 -4.516,-22.255,
        43.284,	-13.215, 21.939,
        55.314,	  8.821,-24.602,
        70.694,	-33.028, -0.114,
        62.655,	 35.348, 57.856,
        40.244,	  9.737,-44.354,
        51.603,	 47.796, 16.896,
        30.495,	 21.067,-20.021,
        72.461,	-23.299, 56.998,
        71.948,	 19.464, 68.121,
        28.872,	 14.808,-50.147,
        55.145,	-37.800, 31.639,
        42.279,	 54.120, 28.667,
        82.274,	  4.017, 79.994,
        51.914,	 49.795,-13.821,
        50.723,	-28.115,-27.954,
        96.529,	 -0.471,  2.420,
        81.210,	 -0.638,  0.274,
        66.483,	 -0.530, -0.004,
        50.828,	 -0.642, -0.136,
        35.854,	 -0.541, -0.491,
        20.813,	  0.031, -0.386
    ];
    sRGBPatches = Matrix.toMatrix(sRGBPatches).reshape(3, 24).transpose()['/='](1);//.display();
    var f = function (color, N, sc, sp, wp, prim) {
        Matrix.Colorspaces['Lab to XYZ'](color, N, sc, sp, wp);
        // Matrix.Colorspaces['XYZ to xyY'](color, N, sc, sp);
        Matrix.Colorspaces['XYZ to LinearRGB'](color, N, sc, sp, wp, prim);
        return color;
    };
    var D50 = [0.3457, 0.3585, 1];
    return linearsRGBPatches = Matrix.toMatrix(f(new Float64Array(sRGBPatches.getData()), 24, 24, 1, D50)).reshape(24, 3).display();

};

var fitColors = function(target, measured) {
    // target = Matrix.bsxfun("rdivide", target, target.mean(1));
    // measured = Matrix.bsxfun("rdivide", measured, measured.mean(1));

    target = target.get([[12, 13, 14, 18]], []);
    measured = measured.get([[12, 13, 14, 18]], []);
    var M = target.transpose().mrdivide(measured.transpose());//.display();
    // impose the wp
    var WP = Matrix.diag(M.mtimes(Matrix.ones(3, 1))).inv();//.display()
    // return M;
    return WP.mtimes(M);
};
var addChromaticitiesFromRgb = function (p, patches, id, color) {
    p.addChromaticitiesFromRgb(
        patches.get([], 0).getData(), 
        patches.get([], 1).getData(), 
        patches.get([], 2).getData(),
        {
            'id': id,
            'stroke': 'none',
            'fill': 'none',
            'marker': {
                'opacity': 0.5,
                'shape': 'circle',
                'fill': color,
                'size': 5,
                'stroke': 'none'
            }
        }
    );
};

window.onload = function () {
    "use strict";
    var M2 = Matrix.toMatrix([
        1.993689, -0.151371, -0.023086,
       -1.152317,  1.359525, -0.796688,
        0.158628, -0.208153,  1.819774
    ]).reshape(3, 3);

    // var sRGBPatches = getsRGBPatches();//.display();
    var sRGBPatches = gretagAmba;
    //var linearsRGBPatches = Matrix.toMatrix(Matrix.Colorspaces['sRGB to LinearRGB'](new Float64Array(sRGBPatches.getData()), 24, 24, 1)).reshape(24, 3);
    /*var f = function (color, N, sc, sp, wp, prim) {
        Matrix.Colorspaces['sRGB to LinearRGB'](color, N, sc, sp);
        Matrix.Colorspaces['LinearRGB to XYZ'](color, N, sc, sp, wp, prim);
        Matrix.Colorspaces['XYZ to xyY'](color, N, sc, sp);
        return color;
    }*/
    //var D50 = [0.3457, 0.3585, 1];
    // var linearsRGBPatches = Matrix.toMatrix(f(new Float64Array(sRGBPatches.getData()), 24, 24, 1, D50)).reshape(24, 3).display();
    // var XYZPatches = Matrix.Colorspaces['RGB to XYZ'](new Float64Array(sRGBPatches.getData()), 24, 24, 1);

    var m, MEASURES = {
        "H":    MEASURESH,
        "A":    MEASURESA, 
        "CW":   MEASURESCW, 
        "D65":  MEASURESD65, 
        "TL84": MEASURESTL84
    }, 
    gretag = {}, matrices = {}, gretagCorrected = {}, gretagCorrectedRef = {};
    // Diagram Plot
    var plotProperties = {
        'ticks-display': false,
        'preserve-ratio': true,
        'legend-display': 'none'
    };
    $('tableCanvas').innerHTML = "";
    

    for (m in MEASURES) {
        gretag[m] = getGretag(MEASURES[m]);
        matrices[m] = fitColors(sRGBPatches, gretag[m]);
        matrices[m].display(m);
        console.log(matrices[m].getData());
        gretagCorrected[m] = matrices[m].mtimes(gretag[m].transpose()).transpose();
        gretagCorrectedRef[m] = M2.mtimes(gretag[m].transpose()).transpose();
        
        var p = new Plot('chromaticityDiagram' + m, [300, 300], 'tableCanvas', plotProperties);
        var p = $("chromaticityDiagram" + m).getPlot().clear();
        p.addChromaticityDiagram('xyY').setXLabel().setYLabel().setTitle(m);
        p.remove("Spectrum locus");
        addChromaticitiesFromRgb(p, sRGBPatches, 'sRGB', 'green');
        addChromaticitiesFromRgb(p, gretagCorrected[m], 'Hero4', 'red');
        // addChromaticitiesFromRgb(p, gretagCorrectedRef[m], 'IMX135', 'blue');
    }

};

